<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–û–±—ä—è–≤–ª–µ–Ω–∏—è</title>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>

  <!-- Tailwind -->
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          fontFamily: {
            sans: ['Manrope', 'sans-serif']
          },
          colors: {
            primary: '#4f46e5',
            secondary: '#4338ca',
            accent: '#f59e0b',
            danger: '#ef4444'
          }
        }
      }
    };
  </script>

  <style>
    body {
      background: linear-gradient(145deg, #e0e7ff, #f8fafc);
    }

    .dark body {
      background: linear-gradient(145deg, #1e293b, #0f172a);
    }

    .glass {
      background: rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(12px);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .toast {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      padding: 12px 20px;
      background: #4f46e5;
      color: white;
      border-radius: 8px;
      font-weight: 600;
      animation: fadein 0.3s, fadeout 0.3s 2.7s;
      z-index: 1000;
    }

    @keyframes fadein {
      from {
        opacity: 0;
        bottom: 0;
      }

      to {
        opacity: 1;
        bottom: 20px;
      }
    }

    @keyframes fadeout {
      from {
        opacity: 1;
        bottom: 20px;
      }

      to {
        opacity: 0;
        bottom: 0;
      }
    }
  </style>
</head>

<body class="text-gray-900 dark:text-gray-100 font-sans transition-colors">
  <div id="toastContainer"></div>
  <main class="container mx-auto p-4 max-w-4xl">
    <header class="flex justify-between items-center mb-6">
      <h1 class="text-3xl font-bold">üì¢ –û–±—ä—è–≤–ª–µ–Ω–∏—è</h1>
      <div class="flex gap-2 items-center">
        <button id="themeToggle" class="px-3 py-2 rounded-xl bg-gray-300 dark:bg-gray-700 text-sm">üåì</button>
        <button id="authButton"
          class="px-4 py-2 rounded-xl bg-primary text-white font-semibold hover:bg-secondary transition">üîê
          –í–æ–π—Ç–∏</button>
      </div>
    </header>

    <form id="adForm" class="glass p-4 rounded-xl mb-6">
      <input type="text" name="title" placeholder="–ó–∞–≥–æ–ª–æ–≤–æ–∫" class="w-full p-2 rounded mb-2" required />
      <textarea name="description" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ" class="w-full p-2 rounded mb-2" required></textarea>
      <input type="text" name="author" placeholder="–í–∞—à–µ –∏–º—è" class="w-full p-2 rounded mb-2" required />
      <select name="category" class="w-full p-2 rounded mb-2">
        <option value="–û–±—â–µ–µ">–û–±—â–µ–µ</option>
        <option value="–ü—Ä–æ–¥–∞–∂–∞">–ü—Ä–æ–¥–∞–∂–∞</option>
        <option value="–°–æ–±—ã—Ç–∏–µ">–°–æ–±—ã—Ç–∏–µ</option>
      </select>
      <input type="file" id="image" accept="image/*" class="mb-2" />
      <button type="submit" class="bg-primary text-white px-4 py-2 rounded hover:bg-secondary">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</button>
    </form>

    <div class="flex justify-between mb-4">
      <input type="text" id="searchInput" placeholder="–ü–æ–∏—Å–∫..." class="w-full p-2 border rounded" />
      <select id="sortSelect" class="ml-2 p-2 rounded">
        <option value="created">–°–Ω–∞—á–∞–ª–∞ –Ω–æ–≤—ã–µ</option>
        <option value="title">–ü–æ –Ω–∞–∑–≤–∞–Ω–∏—é</option>
      </select>
    </div>

    <section id="adsList" class="grid gap-4"></section>
  </main>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCHLAbHqf08LeqlGWhGe1vlOUc_HCk31b4",
      authDomain: "officialbysamaraa.firebaseapp.com",
      projectId: "officialbysamaraa",
      storageBucket: "officialbysamaraa.appspot.com",
      messagingSenderId: "730619245461",
      appId: "1:730619245461:web:b462380b3043b587333c9c",
      measurementId: "G-6XRGSMP72W"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();
    const storage = firebase.storage();
    const ADMIN_EMAILS = ["axmatovaxmat848@gmail.com"];

    function showToast(message, type = "info") {
      const toast = document.createElement("div");
      toast.className = "toast";
      toast.style.background = type === "error" ? "#ef4444" : "#4f46e5";
      toast.textContent = message;
      document.getElementById("toastContainer").appendChild(toast);
      setTimeout(() => toast.remove(), 3000);
    }

    const themeToggle = document.getElementById("themeToggle");
    themeToggle.addEventListener("click", () => {
      document.documentElement.classList.toggle("dark");
      localStorage.setItem("theme", document.documentElement.classList.contains("dark") ? "dark" : "light");
    });
    if (localStorage.getItem("theme") === "dark") {
      document.documentElement.classList.add("dark");
    }

    function renderAdActions(ad) {
      const likeKey = `likes_${ad.id}`;
      const liked = localStorage.getItem(likeKey);
      return `
        <div class="flex gap-4 items-center mt-4">
          <button class="like-btn text-sm text-pink-500 hover:text-pink-600" data-id="${ad.id}">${liked ? 'üíñ –ü–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å' : '‚ù§Ô∏è –ù—Ä–∞–≤–∏—Ç—Å—è'}</button>
          <input placeholder="–î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π..." data-id="${ad.id}" class="comment-input w-full p-1 text-sm border rounded" />
        </div>
        <ul class="comments-list text-sm mt-2 space-y-1" id="comments-${ad.id}"></ul>
      `;
    }

    function addComment(adId, text) {
      const commentList = document.getElementById(`comments-${adId}`);
      const li = document.createElement("li");
      li.textContent = text;
      commentList.appendChild(li);
    }

    document.addEventListener("click", e => {
      if (e.target.classList.contains("like-btn")) {
        const id = e.target.dataset.id;
        const key = `likes_${id}`;
        if (!localStorage.getItem(key)) {
          localStorage.setItem(key, true);
          e.target.textContent = "üíñ –ü–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å";
        }
      }
    });

    document.addEventListener("keypress", e => {
      if (e.target.classList.contains("comment-input") && e.key === "Enter") {
        e.preventDefault();
        const text = e.target.value.trim();
        if (!text) return;
        addComment(e.target.dataset.id, text);
        e.target.value = "";
      }
    });
  </script>
</body>

</html>
